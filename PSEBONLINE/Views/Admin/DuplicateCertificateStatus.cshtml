@model PSEBONLINE.Models.DuplicateCertificate
@{
    ViewBag.Title = "DuplicateCertificateStatus";
    Layout = "~/Views/Shared/_Header.cshtml";
}

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://registration2022.pseb.ac.in/Content/Print-4P.css" />
<script type="text/javascript">   
    $("#btnPrintStatus").live("click", function () {
        var divContents = $("#tblStatus").html();
        var printWindow = window.open('', '', 'height=800,width=1000px');
        printWindow.document.write('<html><head><title>Duplicate Certificate Report Status</title>');
        printWindow.document.write('</head><body >');
        printWindow.document.write(divContents);
        printWindow.document.write('</body></html>');
        printWindow.document.close();
        printWindow.print();
    });
</script>
<style type="text/css">
    .ktm {
        padding: 0 8px !important;
    }

    .lft {
        float: left;
    }

    .rft {
        float: right;
    }
</style>

<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css">
<div class="row" id="divMain1">  
    <div class="col-md-12 text-right">
        @if (ViewBag.TotalCount > 0)
            {
            <input type="button" class="btn" value="Print Status" id="btnPrintStatus" />
        }
    </div>
    <div class="clearfix"></div>
    <div class="col-md-12" id="tblStatus">
        <div class="table-responsive">
            <table width="100%" border="1" style="border-collapse:collapse;width:100%;font-family:Arial, Helvetica, sans-serif;font-size:12px">
                <thead>
                    <tr>
                        <td colspan="2" style="border-right:0 !important"><div style="padding:2px"><img src="~/Images/Printlogo.jpg" width="60px" height="60px" alt="PSEB" /></div></td>
                        <td colspan="6" style="font-size:16px;text-align:center;line-height:24px;vertical-align:top;border-left:0 !important;border-right:0 !important;padding-top:8px">
                            <span style="font-size:28px">Punjab School Education Board</span><br />
                            <span>Duplicate Certificate Status</span>
                        <td align="right" style="border-left:0 !important">Print Date : @DateTime.Now.ToString("dd/MM/yyyy hh:mm") &nbsp;</td>
                    </tr>
                </thead>
                <tr>
                    <th style="color:darkslateblue;text-align:left;font-size:13px" width="10%">Branch</th>
                    <th style="color:black;text-align:center;font-size:13px" width="10%">Total</th>
                    <th style="color:red;text-align:center;font-size:13px" width="10%">Pending</th>
                    <th style="color:darkorange;text-align:center;font-size:13px" width="10%">In Process</th>
                    <th style="color:darkmagenta;text-align:center;font-size:13px" width="10%">Printing</th>
                    <th style="color:dodgerblue;text-align:center;font-size:13px" width="10%">Dealing Set</th>
                    <th style="color:darkred;text-align:center;font-size:13px" width="10%">Objection</th>
                    <th style="color:darkviolet;text-align:center;font-size:13px" width="20%">Certificate Printed</th>
                    <th style="color:darkgreen;text-align:center;font-size:13px" width="20%">Dispatched</th>
                </tr>

               @if (ViewBag.TotalCount > 0)
               {
                   if (Model.StoreAllData.Tables[0].Rows.Count > 0)
                   {
                       for (int p = 0; p < Model.StoreAllData.Tables[0].Rows.Count; p++)
                       {
                           var Br = Model.StoreAllData.Tables[0].Rows[p]["Br"].ToString();
                           var tot = Model.StoreAllData.Tables[0].Rows[p]["tot"].ToString();
                           var pend = Model.StoreAllData.Tables[0].Rows[p]["pend"].ToString();
                           var Prc = Model.StoreAllData.Tables[0].Rows[p]["Prc"].ToString();
                           var Prnt = Model.StoreAllData.Tables[0].Rows[p]["Prnt"].ToString();
                           var dset = Model.StoreAllData.Tables[0].Rows[p]["dset"].ToString();
                           var desp = Model.StoreAllData.Tables[0].Rows[p]["desp"].ToString();
                           var crt = Model.StoreAllData.Tables[0].Rows[p]["crt"].ToString();
                           var dspch = Model.StoreAllData.Tables[0].Rows[p]["dspch"].ToString();
                        <tr>
                            <td style="color:darkslateblue;text-align:left;font-size:13px">&nbsp;@Br</td>
                            <td style="color:black;text-align:center;font-size:13px">@tot</td>
                            <td style="color:red;text-align:center;font-size:13px"> @pend</td>
                            <td style="color:darkorange;text-align:center;font-size:13px"> @Prc</td>
                            <td style="color:darkmagenta;text-align:center;font-size:13px"> @Prnt</td>
                            <td style="color:dodgerblue;text-align:center;font-size:13px"> @dset</td>
                            <td style="color:darkred;text-align:center;font-size:13px"> @desp</td>
                            <td style="color:darkviolet;text-align:center;font-size:13px"> @crt</td>
                            <td style="color:darkgreen;text-align:center;font-size:13px"> @dspch</td>
                        </tr>
                       }
                   }
               }
               else
               {
                <tr><td colspan="9">Record Not Found</td></tr>
                    }

</table>
        </div>
    </div>
</div>




